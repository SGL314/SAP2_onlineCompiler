<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simulador SAP2</title>
<<<<<<< HEAD
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
  <link rel="icon" type="image/x-icon" href="http://www.coltec.ufmg.br/coltec-ufmg/wp-content/uploads/2018/05/cropped-logo-0.png">
  <link rel="stylesheet" href="/css/base.css">
  <link rel="stylesheet" href="/css/buttons.css">
  <link rel="stylesheet" href="/css/editor.css">
  <link rel="stylesheet" href="/css/output.css">
  <link rel="stylesheet" href="/css/login.css">
  <link rel="stylesheet" href="/css/windows.css">
  <link rel="stylesheet" href="/css/slider.css">
  <link rel="stylesheet" href="/css/files.css">
=======
  <link rel="icon" type="image/x-icon"
    href="http://www.coltec.ufmg.br/coltec-ufmg/wp-content/uploads/2018/05/cropped-logo-0.png">
  <link rel="stylesheet" href="../css/base.css">
  <link rel="stylesheet" href="../css/buttons.css">
  <link rel="stylesheet" href="../css/editor.css">
  <link rel="stylesheet" href="../css/output.css">
  <link rel="stylesheet" href="../css/login.css">
  <link rel="stylesheet" href="../css/windows.css">
  <link rel="stylesheet" href="../css/slider.css">
  <link rel="stylesheet" href="../css/files.css">
>>>>>>> 86fe2ed5172ca22ab2774434e4e9030b76ab2dd9
</head>

<body class="dark-theme">
  <header class="top-bar">
    <h1>Simulador SAP2<br></h1>
    <div class="buttons">
      <button class="btn">COMPILAR</button>
      <button class="btn">EXECUTAR</button>
      <button class="btn">HZ</button>
      <button class="btn">CONF</button>
    </div>
  </header>

  <main class="main-area">
    <section class="section-files" id="painel">
      <h2>FILES</h2><br>
      <input type="file" id="seletor" webkitdirectory multiple>
      <div class="files">
      </div>
      <div class="alca" id="alca"></div>
    </section>

    <section class="middle-part">
      <section class="janelas">
        <h2>
          Janelas :
        </h2>
        <h2 id="identificador-arquivo-acessado"> Nenhum arquivo selecionado</h2>
        <br><br>
        <button id="button-save">Salvar</button>
      </section>
      <section class="editor">
        <textarea id="textArea" placeholder="Insira o código aqui ..."></textarea>
      </section>
    </section>

    <div class="right-part">
      <section class="sap2">
        <h2>SAP 2</h2>
        <canvas id="sap2-canvas" height="100" width="100">
        </canvas>
      </section>
      <script>
        let cnv;
        var fios = [0,0,0,0,0,0,0,0]

        function setup() {
          // Cria o canvas via p5 normalmente
          cnv = createCanvas(800,800);
          // Coloca o canvas DENTRO do canvas HTML (substitui o conteúdo)
          const container = document.getElementById("sap2-canvas").parentNode;
          document.getElementById("sap2-canvas").remove(); // remove o canvas original
          cnv.parent(container); // coloca o novo p5 canvas no lugar

          const tamanhoDefault = document.querySelector(".files"); // peg tamanho que define ele, a classe css files
          const sec = document.querySelector(".sap2");
          cnv = createCanvas(sec.clientWidth, sec.clientHeight);
          cnv.parent(sec);
        }

        function draw() {
          background("#ffffff");
          fill(255, 100, 0);
          // circle(frameCount % width, 100, 40);

          const sec = document.querySelector(".files");

          

          mapSap2();

          // verifica se o tamanho mudou
          if ((height !== sec.clientHeight) && (sec.clientHeight <= 800) ) {
            resizeCanvas(sec.clientHeight, sec.clientHeight);
          }
          activateFio(0,1);
          // activateFio(7,1);
        }

        function activateFio(numFio,data){
          for (let i=0; i<8; i++){
            if (i == numFio){
              fios[i] = data;
            }
          }
        }

        function mapSap2(){
          var rtr = 1,pady=0; // retortion
          var mrgx=100/3*rtr, mrgy = mrgx; // margins
          var tamFio = 3;
          var gapFioComponent = 2.5;

          stroke(1);
          
          
          fill("#4d81c0");
          rect(mrgx,mrgy+50*rtr,200*rtr,50*rtr);// in port
          rect(mrgx,mrgy+(50+50)*rtr*1+50*rtr,200*rtr,50*rtr);// PC
          rect(mrgx,mrgy+(50+50)*rtr*2+50*rtr,200*rtr,50*rtr);// mar memory acess register
          rect(mrgx,mrgy+(50+50)*rtr*3+50*rtr,200*rtr,50*rtr);// ram 
          rect(mrgx,mrgy+(50+50)*rtr*4+50*rtr,200*rtr,50*rtr);// mdr memory data register
          rect(mrgx,mrgy+(50+50)*rtr*5+50*rtr,200*rtr,50*rtr);// ir instruction register
          rect(mrgx,mrgy+(50+50)*rtr*6+50*rtr,200*rtr,50*rtr);// con

          rect(mrgx+(200+50*2+(8+8-1)*tamFio+gapFioComponent)*rtr,mrgy+(50+50)*rtr*1-50*rtr*2,200*rtr,50*rtr);// A
          rect(mrgx+(200+50*2+(8+8-1)*tamFio+gapFioComponent)*rtr,mrgy+(50+50)*rtr*2-50*rtr*2,200*rtr,50*rtr);// ALU
          rect(mrgx+(200+50*2+(8+8-1)*tamFio+gapFioComponent)*rtr,mrgy+(50+50)*rtr*3-50*rtr*2,200*rtr,50*rtr);// TEMP
          rect(mrgx+(200+50*2+(8+8-1)*tamFio+gapFioComponent)*rtr,mrgy+(50+50)*rtr*4-50*rtr*2,200*rtr,50*rtr);// B
          rect(mrgx+(200+50*2+(8+8-1)*tamFio+gapFioComponent)*rtr,mrgy+(50+50)*rtr*5-50*rtr*2,200*rtr,50*rtr);// C
          rect(mrgx+(200+50*2+(8+8-1)*tamFio+gapFioComponent)*rtr,mrgy+(50+50)*rtr*7-50*rtr*2,200*rtr,50*rtr);// out
          // rect(mrgx+(200+50*2+(8+8-1)*tamFio+gapFioComponent)*rtr,mrgy+(50+50)*rtr*7-50*rtr*0,200*rtr,50*rtr);// PC
          
          // fill("#000000");
          // line(mrgx,mrgy+50/2*rtr, mrgx+200*rtr, mrgy+50/2*rtr);
          
          // 8 lines
          for (var unity of [0,1,2,3,4,5]){
            pady = unity*(50+50)*rtr+50*rtr;
            

            if (unity==5) pady += 50*rtr*2;
            for (let i=0; i<8; i++){
              fill("#4d81c0");
              noStroke();
              if (fios[i]==1){
                fill("#ff0000");
              }
              // to bus
              rect(mrgx+200*rtr+(50*2+(8+8-1)*tamFio+gapFioComponent)*rtr-50*rtr, (mrgy+gapFioComponent*rtr+i*6*rtr)+pady-50*rtr, 50*rtr,tamFio*rtr);
              // to conection
              rect(mrgx+200*rtr+50*rtr+(tamFio+gapFioComponent+i*(tamFio*2))*rtr, (mrgy+gapFioComponent*rtr+i*6*rtr)+pady-50*rtr, (tamFio*2*8-tamFio)*rtr*((8-i)/8),tamFio*rtr);
            }
            pady = unity*(50+50)*rtr+50*rtr;

            if (unity==3) continue;
            for (let i=0; i<8; i++){
              fill("#4d81c0");
              noStroke();
              if (fios[8-i-1]==1){
                fill("#ff0000");
              }
              // to bus
              rect(mrgx+200*rtr, (mrgy+gapFioComponent*rtr+i*6*rtr)+pady, 50*rtr,tamFio*rtr);
              // to conection
              rect(mrgx+200*rtr+50*rtr, (mrgy+gapFioComponent*rtr+i*6*rtr)+pady, (tamFio*2*8-tamFio)*rtr*((8-i)/8),tamFio*rtr);
            }
          }
          
          for (var i = 0 ; i < 16; i ++){
            fill("#4d81c0");
            rect(mrgx+(200/2-(tamFio*2)-tamFio)*rtr,mrgy+(50+50)*3*rtr,
             tamFio*rtr, 50*rtr);
          }

         
          padx = (200+50)*rtr;

          // bus
          for (let i=0; i<8; i++){
            fill("#4d81c0");
            noStroke();
            if (fios[i]==1){
              fill("#ff0000");
            }
            rect(mrgx+padx+tamFio*rtr*(i+1)+tamFio*i*rtr, mrgy-5,tamFio*rtr, ((50+50)*7-50+5)*rtr);
            // if (i==1) break;
          }

          texts(rtr,mrgx,mrgy,gapFioComponent,tamFio);
        }

        function texts(rtr,mrgx,mrgy,gapFioComponent,tamFio){
          stroke(1);
          fill("#000000");
          textSize(20);
          var textos = ["IN Port","PC","MAR","RAM","MDR","IR","CON"];
          for (let i=0; i<textos.length; i++){
            text(textos[i],mrgx+(200/2)*rtr-textWidth(textos[i])/2,mrgy+50*rtr/2+(textAscent()-textDescent())/2+(50+50)*rtr*(i)+50*rtr);
          }

          textos = ["A","ALU","TEMP","B","C","","OUT"];
          for (let i=0; i<textos.length; i++){
            text(textos[i],mrgx+(200/2)*rtr-textWidth(textos[i])/2+(200+50*2+(8+8-1)*tamFio+gapFioComponent)*rtr,mrgy+50*rtr/2+(textAscent()-textDescent())/2+(50+50)*rtr*(i));
          }
          
        }

        


      </script>

      <section class="hex-display">
        <h2>HEXA - DISPLAY</h2>
        <pre class="hex-output">--:--:--</pre>
      </section>

      <section class="output">
        <h2>OUTPUT</h2>
        <pre class="output-log">Aguardando execução ...</pre>
      </section>
    </div>
  </main>

  <aside class="login-window">
    <h3>Login</h3>
    <div class="open-hover">
      <div id="user-info" style="display:none;">
        <span id="user-name"></span>
        <button id="signOutBtn" class="btn">Sair</button>
      </div>
      <div id="signInButtons">
        <button id="loginGoogle" class="btn">Entrar com Google</button>
      </div>
    </div>
  </aside>

  <!-- Scripts -->
  <script type="module" src="../js/firebase.js"></script>
  <script type="module" src="../js/auth.js"></script>
  <script src="../js/uteis.js"></script>
  <script src="../js/compilador.js"></script>
  <script src="../js/cpu.js"></script>

  <script type="module" src="../js/interface.js"></script>

  <footer class="footer">
    <p>Desenvolvido para auxiliar na matéria de OCS | Professor Humberto Honda</p>
    <p>By: Júlia Martins | Samuel Lobato | Giovana Nunes</p>
    <p>© 2025 COLTEC - Todos os direitos reservados.</p>
  </footer>
</body>

</html>